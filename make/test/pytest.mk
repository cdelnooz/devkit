#
# PYTEST.MK --Rules for running tests with Python's "pytest" framework.
#
# Contents:
# test-pytest-xml[%]: --Run a test and generate junit test output.
# clean-pytest:       --Cleanup files generated by running tests.
#
# Remarks:
# These rules runs the tests defined by the PY_TESTS explicitly.
#

PY_TESTS ?= $(PY_SRC)
PYTEST ?= py.test

test:	$(PY_TESTS:%.py=test-pytest[%])

test-pytest[%]:
	$(PYTEST) $*.py

test-xml:	$(PY_TESTS:%.py=test-pytest-xml[%])

#
# test-pytest-xml[%]: --Run a test and generate junit test output.
#
test-pytest-xml[%]:
	$(PYTEST) --junit-xml=$*.xml $*.py


clean:		clean-pytest
distclean:	clean-pytest

#
# clean-pytest: --Cleanup files generated by running tests.
#
.PHONY:		clean-pytest
clean-pytest:
	$(RM) -r __pycache__ $(PY_TESTS:%.py=%.xml)
